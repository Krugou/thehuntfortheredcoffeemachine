# This file was auto-generated by the Firebase CLI
# https://github.com/firebase/firebase-tools

name: Deploy to Firebase Hosting on merge
'on':
 push:
  branches:
   - main
 workflow_dispatch:

permissions:
 contents: read
 id-token: write
jobs:
 build_and_deploy:
  environment:
   name: github-pages
   url: https://thehuntfortheredcoffeemachine.web.app/
  runs-on: ubuntu-latest
  steps:
   - name: Checkout
     uses: actions/checkout@v4
   - name: install dependencies
     run: npm install
     working-directory: ./thegame
   - name: Building the app
     run: VITE_BUILD_DATE=$(date) npm run build
     working-directory: ./thegame
     env:
      VITE_APP_FIREBASE_API_KEY: ${{ secrets.VITE_APP_FIREBASE_API_KEY }}
      VITE_APP_FIREBASE_AUTH_DOMAIN: ${{ secrets.VITE_APP_FIREBASE_AUTH_DOMAIN }}
      VITE_APP_FIREBASE_PROJECT_ID: ${{ secrets.VITE_APP_FIREBASE_PROJECT_ID }}
      VITE_APP_FIREBASE_STORAGE_BUCKET: ${{ secrets.VITE_APP_FIREBASE_STORAGE_BUCKET }}
      VITE_APP_FIREBASE_MESSAGING_SENDER_ID: ${{ secrets.VITE_APP_FIREBASE_MESSAGING_SENDER_ID }}
      VITE_APP_FIRE_APP_ID: ${{ secrets.VITE_APP_FIRE_APP_ID }}
   - uses: FirebaseExtended/action-hosting-deploy@v0
     with:
      repoToken: '${{ secrets.GITHUB_TOKEN }}'
      firebaseServiceAccount: >-
       ${{ secrets.FIREBASE_SERVICE_ACCOUNT_THEHUNTFORTHEREDCOFFEEMACHINE
       }}
      channelId: live
      projectId: thehuntfortheredcoffeemachine
